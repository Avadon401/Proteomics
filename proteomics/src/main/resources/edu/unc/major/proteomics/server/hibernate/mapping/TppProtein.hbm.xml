<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
 
<hibernate-mapping>
    <class name="edu.unc.major.proteomics.share.model.TppProtein" table="TppProtein" catalog="signal">
        <id name="id" type="java.lang.Long">
            <column name="ID" />
            <generator class="identity" />
        </id>
        <many-to-one name="gene" class="edu.unc.major.proteomics.share.model.NcbiGene" column="GeneID"/>
        <property name="proteinDec" type="string">
            <column name="ProteinDec"/>
        </property>
        <property name="probability" type="java.lang.Float">
            <column name="Probability" />
        </property>
        <property name="totalNumPeptides" type="java.lang.Integer">
            <column name="TOTAL_NUMBER_PEPTIDES" />
        </property>
        <property name="uniqueNumPeptides" type="java.lang.Integer">
            <column name="UNIQUE_NUMBER_PEPTIDES" />
        </property>
        <property name="xpressRatioMean" type="java.lang.Float">
            <column name="XPRESSRATIO_MEAN" />
        </property>
        <property name="xpressRatioStdDev" type="java.lang.Float">
            <column name="XPRESSRATIO_STANDARD_DEV" />
        </property>
        <set name="identifiers" lazy="false">
        	<key column="TppProteinID"/>
        	<one-to-many class="edu.unc.major.proteomics.share.model.TppProteinIndProtein"/>
        </set>      
        <many-to-one name="band" class="edu.unc.major.proteomics.share.model.Band" column="BandID"/>  
    </class>
    
<query name="TppProtein.byGene.byId">
	from TppProtein p
	inner join fetch p.gene
	inner join fetch p.band
	inner join fetch p.band.bait
	inner join fetch p.band.bait.gene
	where p.gene.id in (:id) and p.gene.id != p.band.bait.gene.id and p.totalNumPeptides > 0
	order by p.gene.geneName, p.totalNumPeptides desc
</query> 

 <query name="TppProtein.byGene.byId,size">
 	select count(*)
	from TppProtein p
	where p.gene.id in (:id) and p.gene.id != p.band.bait.gene.id and p.totalNumPeptides > 0
</query> 
</hibernate-mapping>